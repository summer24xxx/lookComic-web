(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d143eeee"],{"040e":function(t,e,a){},"1be6":function(t,e,a){"use strict";var n=function(){var t=this,e=t._self._c;return e("div",[t.loading?e("div",{staticClass:"spinner-border text-dark",attrs:{role:"status"}},[e("span",{staticClass:"sr-only"},[t._v("Loading...")])]):t._e(),e("img",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],ref:"image",staticClass:"page-img border border-light rounded mt-2 mb-2",attrs:{alt:t.src,src:t.src},on:{load:t.loadingEvent}})])},i=[],o={name:"ImageCard",props:{src:String,view:{type:String,default:null}},data:function(){return{loading:!0}},methods:{loadingEvent:function(){this.loading=!1,"top"===this.view?this.topIntoView():"bottom"===this.view&&this.bottomIntoView()},topIntoView:function(){var t=this;this.$nextTick((function(){t.$refs.image.scrollIntoView(!0)}))},bottomIntoView:function(){var t=this;this.$nextTick((function(){t.$refs.image.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})}))}}},r=o,s=(a("e81a"),a("2877")),c=Object(s["a"])(r,n,i,!1,null,"440eb63a",null);e["a"]=c.exports},2765:function(t,e,a){"use strict";(function(t){var n=a("5530"),i=(a("14d9"),a("2f62")),o=a("4012"),r=a("1be6"),s=5;e["a"]={name:"Dropdown",components:{ImageCard:r["a"],DropdownMenu:o["a"]},props:{},data:function(){return{imgList:[],footer:!1,header:!1,state:null}},computed:Object(n["a"])({},Object(i["c"])(["chapter","prevChapter","nextChapter","currentPage"])),created:function(){var e=this;this.$emit("toggle-header",!1),this.appendPages(),this.$nextTick((function(){e.state="init"})),t(window).on("scroll.a",(function(){var a=t(window).scrollTop(),n=e.$refs.top.offsetTop;if(void 0===e.position.top)e.initPage();else{var i=e.position.bottom-e.position.top;if(a>e.position.scrollTop){var o=t(window).height(),r=t(document).height();a+o+10>=r&&(e.imgList[e.imgList.length-1]<e.chapter.pages?e.appendPages():e.footer=!0),a>e.position.top+4*i/5&&e.nextPage()}else a<n&&e.position.scrollTop+1>=n&&(1!==e.imgList[0]?e.unshiftPages():(e.header=!0,e.$emit("toggle-header",!0))),a<e.position.top+i/5&&e.prevPage()}e.position.scrollTop=a})),window.onbeforeunload=function(){e.$store.dispatch("SyncRecord",e.getCurrentPage())}},mounted:function(){this.position={top:void 0,bottom:void 0,scrollTop:0,page:0}},beforeDestroy:function(){t(window).off("scroll.a")},methods:{imgPath:function(t){return"/api/"+this.chapter.comic.title+"/"+this.chapter.title+"/"+t.format(3)+this.chapter.suffix},appendPages:function(){var e=this,a=this.imgList.length?this.currentPage+1:this.currentPage;if(!this.imgList.length||a===this.imgList[this.imgList.length-1]+1){var n,i=Math.min(a+s,this.chapter.pages+1),o=[];while(a<i)o.push(a++);(n=this.imgList).push.apply(n,o),this.$nextTick((function(){e.pages=t(".page")}))}},unshiftPages:function(){var e=this;0===this.position.page&&(this.imgList.unshift(Math.max(this.currentPage-1,1)),this.state="up",this.$nextTick((function(){e.pages=t(".page"),e.changePage(e.position.page),e.$store.commit("PREV_PAGE"),console.log(e.currentPage)})))},initPage:function(){this.changePage(0)},prevPage:function(){this.changePage(this.position.page-1)&&(console.log("prev page"),this.$store.commit("PREV_PAGE"),console.log(this.currentPage))},nextPage:function(){this.changePage(this.position.page+1)&&(console.log("next page"),this.$store.commit("NEXT_PAGE"),console.log(this.currentPage))},changePage:function(t){if(t<0||t>=this.imgList.length)return!1;var e=this.pages[t];return this.position.top=e.offsetTop,this.position.bottom=e.offsetTop+e.offsetHeight,this.position.page=t,console.log(this.position),!0},getCurrentPage:function(){return this.currentPage}}}}).call(this,a("1157"))},"2ba7":function(t,e,a){"use strict";a("040e")},3091:function(t,e,a){},3125:function(t,e,a){"use strict";(function(t){var n=a("5530"),i=(a("99af"),a("14d9"),a("e33e")),o=a("d124"),r=a("2f62"),s=a("4ec3"),c=a("c8f2");e["a"]={name:"Chapter",components:{Favourite:c["a"],OnePage:i["a"],Dropdown:o["a"]},data:function(){return{loading:!1,favourite:!1,dropdown:!0,header:!0}},computed:Object(n["a"])(Object(n["a"])({},Object(r["c"])(["chapter","prevChapter","nextChapter","currentPage"])),{},{chapterId:function(){return this.$route.params.id}}),beforeCreate:function(){document.querySelector("body").setAttribute("style","background-color: rgb(245, 245, 245)")},beforeDestroy:function(){document.querySelector("body").removeAttribute("style")},created:function(){this.initStyle(),this.fetchData()},watch:{$route:"fetchData"},methods:Object(n["a"])({initStyle:function(){void 0===localStorage.dropdown&&(localStorage.dropdown=!0),this.dropdown="true"===localStorage.dropdown},fetchData:function(){var t=this;this.loading=!0,s["e"].get("/api/chapter/"+this.chapterId).then((function(e){t.$store.commit("INIT",e),t.favourite=e.favourite,document.title="".concat(t.chapter.comic.title," - ").concat(t.chapter.title),t.loading=!1}))},changeStyle:function(){this.dropdown=!this.dropdown,localStorage.dropdown=this.dropdown},toggleHeader:function(t){this.header=t},menuMouseleave:function(){t("#menu-content").slideUp(800)},menuIconMouseenter:function(){t("#menu-content").slideDown("fast")},menuClick:function(){this.$store.dispatch("SyncRecord",this.currentPage),this.$router.push("/comic/".concat(this.chapter.comic.id))}},Object(r["b"])({prevChapterEvent:"PrevChapter",nextChapterEvent:"NextChapter"}))}}).call(this,a("1157"))},4012:function(t,e,a){"use strict";var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-center row justify-content-center mt-4 mb-4 dropDown"},[t.prevChapter?e("button",{staticClass:"btn btn-info",on:{click:function(e){t.preChapterEvent(t.getCurrentPage())}}},[t._v(" 上一卷 ")]):t._e(),e("router-link",{staticClass:"ml-5 btn btn-info",attrs:{to:"/comic/"+t.chapter.comic.id,type:"button"}},[t._v(" 目录 ")]),t.nextChapter?e("button",{staticClass:"ml-5 btn btn-info",on:{click:function(e){t.nextChapterEvent(t.getCurrentPage())}}},[t._v(" 下一卷 ")]):t._e()],1)},i=[],o=a("5530"),r=a("2f62"),s={name:"DropdownMenu",props:{getCurrentPage:Function},computed:Object(o["a"])({},Object(r["c"])(["prevChapter","chapter","nextChapter"])),methods:Object(o["a"])({},Object(r["b"])({prevChapterEvent:"PrevChapter",nextChapterEvent:"NextChapter"}))},c=s,u=a("2877"),p=Object(u["a"])(c,n,i,!1,null,"36c32f14",null);e["a"]=p.exports},8366:function(t,e,a){"use strict";a("dcbc")},"88d6":function(t,e,a){"use strict";a("3091")},"9a19":function(t,e,a){},c831:function(t,e,a){"use strict";a("ca3e")},c8f2:function(t,e,a){"use strict";var n=function(){var t=this,e=t._self._c;return t.isLogin()?e("span",[t.fav?e("button",{staticClass:"btn btn-outline-light btn-favourite",attrs:{"data-placement":t.position,"data-toggle":"tooltip",title:"取消订阅"},on:{click:function(e){return t.deleteFav()}}},[e("img",{attrs:{alt:"/images/icons/heart-fill.svg",height:"30px",src:"/api/images/icons/heart-fill.svg",width:"30px"}})]):e("button",{staticClass:"btn btn-outline-light btn-favourite",attrs:{"data-placement":t.position,"data-toggle":"tooltip",title:"订阅"},on:{click:function(e){return t.addFav()}}},[e("img",{attrs:{alt:"/images/icons/heart.svg",height:"30px",src:"/api/images/icons/heart.svg",width:"30px"}})])]):t._e()},i=[],o=(a("a9e3"),a("3786")),r=a("4ec3"),s={name:"Favourite",props:{favourite:Boolean,comicId:[Number,String],position:{type:String,default:"top"}},data:function(){return{fav:this.favourite}},methods:{isLogin:function(){return Object(o["c"])()},addFav:function(){var t=this;r["e"].post("/api/comic/"+this.comicId+"/addFavourite").then((function(){t.fav=!0}))},deleteFav:function(){var t=this;r["e"].post("/api/comic/"+this.comicId+"/deleteFavourite").then((function(){t.fav=!1}))}}},c=s,u=a("2877"),p=Object(u["a"])(c,n,i,!1,null,"04e9f0b4",null);e["a"]=p.exports},ca3e:function(t,e,a){},d124:function(t,e,a){"use strict";a("fb6a");var n=function(){var t=this,e=t._self._c;return e("div",[e("dropdown-menu",{directives:[{name:"show",rawName:"v-show",value:t.header,expression:"header"}],attrs:{"get-current-page":t.getCurrentPage}}),e("div",{staticClass:"text-center",attrs:{id:"main-pages"}},[e("span",{ref:"top"}),e("div",{staticClass:"page"},["init"===t.state?e("ImageCard",{attrs:{src:t.imgPath(t.imgList[0]),view:"top"}}):"up"===t.state?e("ImageCard",{attrs:{src:t.imgPath(t.imgList[0]),view:"bottom"}}):t._e(),e("span",{staticClass:"footer text-secondary"},[t._v(t._s(t.imgList[0]+"/"+t.chapter.pages))])],1),t._l(t.imgList.slice(1),(function(a){return e("div",{key:a,staticClass:"page"},[e("ImageCard",{ref:"img"+a,refInFor:!0,attrs:{src:t.imgPath(a)}}),e("span",{staticClass:"footer text-secondary"},[t._v(t._s(a+"/"+t.chapter.pages))])],1)}))],2),e("dropdown-menu",{directives:[{name:"show",rawName:"v-show",value:t.footer,expression:"footer"}],attrs:{"get-current-page":t.getCurrentPage}})],1)},i=[],o=a("2765"),r=o["a"],s=(a("2ba7"),a("2877")),c=Object(s["a"])(r,n,i,!1,null,"cac75b86",null);e["a"]=c.exports},d18d:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"chapter"}},[t.loading?e("div",{staticClass:"text-center"},[t._v(" 加载中... ")]):t._e(),t.chapter?e("div",[t.header?[e("div",{staticClass:"header mb-4 text-center mt-4",attrs:{id:"page-header"}},[e("h2",[e("router-link",{staticClass:"muted-link",attrs:{to:"/comic/".concat(t.chapter.comic.id)}},[t._v(t._s(t.chapter.comic.title))]),t._v(" "+t._s(" 第"+t.chapter.title+"卷")+" ")],1)]),e("div",{staticClass:"form-check text-center"},[e("input",{staticClass:"form-check-input",attrs:{id:"read-style",type:"checkbox"},domProps:{checked:t.dropdown},on:{change:t.changeStyle}}),e("label",{staticClass:"form-check-label",attrs:{for:"read-style"}},[t._v(" 下拉式阅读 ")])])]:t._e(),e(t.dropdown?"dropdown":"one-page",{tag:"component",on:{"toggle-header":t.toggleHeader}}),e("div",{attrs:{id:"menu"},on:{mouseleave:t.menuMouseleave}},[e("div",{staticClass:"text-center btn-group",attrs:{id:"menu-content",role:"group"}},[e("button",{staticClass:"btn btn-outline-light",attrs:{"data-original-title":"切换阅读方式","data-placement":"left","data-toggle":"tooltip",id:"menu-read-style",title:"",type:"button"},on:{click:t.changeStyle}},[e("img",{attrs:{alt:"/images/icons/arrow-repeat.svg",height:"30px",src:"/api/images/icons/arrow-repeat.svg",width:"30px"}})]),e("br"),e("favourite",{attrs:{"comic-id":t.chapter.comic.id,favourite:t.favourite,position:"left"}}),e("br"),t.prevChapter?[e("button",{staticClass:"btn btn-outline-light",attrs:{"data-original-title":"上一章","data-placement":"left","data-toggle":"tooltip",type:"button"},on:{click:function(e){return t.prevChapterEvent(t.currentPage)}}},[e("svg",{staticClass:"icon",attrs:{"p-id":"2633",t:"1575400052204",version:"1.1",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{d:"M830.24 685.76l11.328-11.312a16 16 0 0 0 0-22.64L530.448 340.688a16 16 0 0 0-22.64 0L196.688 651.808a16 16 0 0 0 0 22.64l11.312 11.312a16 16 0 0 0 22.624 0l288.496-288.512L807.632 685.76a16 16 0 0 0 22.624 0z","p-id":"2634"}})])]),e("br")]:t._e(),e("button",{staticClass:"btn btn-outline-light",attrs:{"data-original-title":"目录","data-placement":"left","data-toggle":"tooltip",type:"button"},on:{click:t.menuClick}},[e("svg",{staticClass:"icon",attrs:{"p-id":"2869",t:"1575400455009",version:"1.1",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{d:"M343.312 374.256v-16a16 16 0 0 1 16-16h23.648a16 16 0 0 1 16 16v16a16 16 0 0 1-16 16h-23.648a16 16 0 0 1-16-16z m100.16 0v-16a16 16 0 0 1 16-16H650.08a16 16 0 0 1 16 16v16a16 16 0 0 1-16 16H459.472a16 16 0 0 1-16-16z m-100.16 144.704v-16a16 16 0 0 1 16-16h23.648a16 16 0 0 1 16 16v16a16 16 0 0 1-16 16h-23.648a16 16 0 0 1-16-16z m100.16 0v-16a16 16 0 0 1 16-16H650.08a16 16 0 0 1 16 16v16a16 16 0 0 1-16 16H459.472a16 16 0 0 1-16-16z m-100.16 144.688v-16a16 16 0 0 1 16-16h23.648a16 16 0 0 1 16 16v16a16 16 0 0 1-16 16h-23.648a16 16 0 0 1-16-16z m100.16 0v-16a16 16 0 0 1 16-16H650.08a16 16 0 0 1 16 16v16a16 16 0 0 1-16 16H459.472a16 16 0 0 1-16-16zM256 240v541.92h497.392V240H256z m529.392 589.92H224a16 16 0 0 1-16-16V208a16 16 0 0 1 16-16h561.392a16 16 0 0 1 16 16v605.92a16 16 0 0 1-16 16z","p-id":"2870"}})])]),e("br"),t.nextChapter?e("button",{staticClass:"btn btn-outline-light",attrs:{"data-original-title":"下一章","data-placement":"left","data-toggle":"tooltip",type:"button"},on:{click:function(e){return t.nextChapterEvent(t.currentPage)}}},[e("svg",{staticClass:"icon",attrs:{"p-id":"2515",t:"1575399554787",version:"1.1",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{d:"M830.24 340.688l11.328 11.312a16 16 0 0 1 0 22.624L530.448 685.76a16 16 0 0 1-22.64 0L196.688 374.624a16 16 0 0 1 0-22.624l11.312-11.312a16 16 0 0 1 22.624 0l288.496 288.496 288.512-288.496a16 16 0 0 1 22.624 0z","p-id":"2516"}})])]):t._e()],2),e("img",{attrs:{alt:"",id:"menu-icon",src:"/api/images/list-unordered.svg"},on:{mouseenter:t.menuIconMouseenter}})])],2):t._e()])},i=[],o=a("3125"),r=o["a"],s=(a("88d6"),a("2877")),c=Object(s["a"])(r,n,i,!1,null,"7eb584de",null);e["default"]=c.exports},da36:function(t,e,a){"use strict";(function(t){var n=a("5530"),i=a("fe1a"),o=a("2f62"),r=a("fa7d"),s=a("1be6");e["a"]={name:"OnePage",components:{ImageCard:s["a"],OnePageMenu:i["a"]},props:{},data:function(){return{cursor:"default"}},computed:Object(n["a"])(Object(n["a"])({},Object(o["c"])(["chapter","prevChapter","nextChapter","currentPage"])),{},{imgPath:function(){return"/api/"+this.chapter.comic.title+"/"+this.chapter.title+"/"+this.currentPage.format(3)+this.chapter.suffix}}),created:function(){var t=this;window.onbeforeunload=function(){t.$store.dispatch("SyncRecord",t.currentPage)}},mounted:function(){this.menuHeader=t("#menu-header")},methods:{scrollToMenu:function(){t(document).scrollTop(this.menuHeader[0].offsetTop)},prePage:function(){var t=this;this.currentPage>1?(this.$store.commit("PREV_PAGE"),this.$nextTick((function(){return t.scrollToMenu()}))):this.prevChapter&&confirm("已经是第一页了，是否跳转到上一章节？")&&this.$store.dispatch("PrevChapter",this.currentPage)},nextPage:function(){var t=this;this.currentPage<this.chapter.pages?(this.$store.commit("NEXT_PAGE"),this.$nextTick((function(){return t.scrollToMenu()}))):this.nextChapter&&confirm("已经是本篇章最后一页了，是否跳转到下一章节？")&&this.$store.dispatch("NextChapter",this.currentPage)},documentClick:function(t){Object(r["c"])()?this.nextPage():window.outerWidth>5*t.screenX/2?this.prePage():window.outerWidth<5*t.screenX/3&&this.nextPage()},documentMousemove:function(t){window.outerWidth>5*t.screenX/2||window.outerWidth<5*t.screenX/3?this.cursor="pointer":this.cursor="default"}}}}).call(this,a("1157"))},dcbc:function(t,e,a){},e33e:function(t,e,a){"use strict";var n=function(){var t=this,e=t._self._c;return e("div",[e("one-page-menu",{attrs:{"next-page":t.nextPage,"prev-page":t.prePage,id:"menu-header"}}),e("div",{staticClass:"text-center",style:{cursor:t.cursor},attrs:{id:"main-pages"},on:{click:function(e){return t.documentClick(e)},mousemove:function(e){return t.documentMousemove(e)}}},[e("div",{staticClass:"page"},[e("ImageCard",{attrs:{src:t.imgPath}})],1)]),e("one-page-menu",{attrs:{"next-page":t.nextPage,"prev-page":t.prePage}})],1)},i=[],o=a("da36"),r=o["a"],s=(a("c831"),a("2877")),c=Object(s["a"])(r,n,i,!1,null,"314ff17a",null);e["a"]=c.exports},e81a:function(t,e,a){"use strict";a("9a19")},fe1a:function(t,e,a){"use strict";var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-center justify-content-center mt-4 mb-4 onePage"},[t.prevChapter?e("button",{staticClass:"btn btn-info pre-chapter",on:{click:function(e){return t.prevChapterEvent(t.currentPage)}}},[t._v(" 上一卷 ")]):t._e(),e("button",{staticClass:"btn btn-outline-danger btn-sm ml-4",on:{click:t.prevPage}},[t._v("上一页")]),e("select",{staticClass:"my-custom-select mr-sm-2 ml-4",domProps:{value:t.currentPage},on:{change:t.updatePage}},t._l(t.chapter.pages,(function(a){return e("option",{key:a,domProps:{selected:a===t.currentPage,value:a}},[t._v(" "+t._s(a)+" ")])})),0),e("span",{staticClass:"text-muted"},[t._v("/"+t._s(t.chapter.pages))]),e("button",{staticClass:"btn btn-outline-danger btn-sm ml-4",on:{click:t.nextPage}},[t._v("下一页")]),t.nextChapter?e("button",{staticClass:"btn btn-info ml-4 next-chapter",on:{click:function(e){return t.nextChapterEvent(t.currentPage)}}},[t._v(" 下一卷 ")]):t._e()])},i=[],o=a("5530"),r=a("2f62"),s={name:"OnePageMenu",props:{prevPage:Function,nextPage:Function},computed:Object(o["a"])({},Object(r["c"])(["chapter","prevChapter","nextChapter","currentPage"])),methods:Object(o["a"])({updatePage:function(t){this.$store.commit("GOTO_PAGE",parseInt(t.target.value))}},Object(r["b"])({prevChapterEvent:"PrevChapter",nextChapterEvent:"NextChapter"}))},c=s,u=(a("8366"),a("2877")),p=Object(u["a"])(c,n,i,!1,null,"6a637b8b",null);e["a"]=p.exports}}]);
//# sourceMappingURL=chunk-d143eeee.643f932a.js.map