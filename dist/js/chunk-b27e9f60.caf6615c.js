(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b27e9f60"],{"0c22":function(t,e,a){"use strict";a.r(e);a("b0c0");var i=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"comic"}},[t.loading?e("div",[e("h4",[t._v("加载中...")])]):t._e(),t.comic?e("div",{staticClass:"card",attrs:{id:"comic-summary"}},[e("div",{staticClass:"row no-gutters mb-3"},[e("div",{staticClass:"col-sm-3"},[e("img",{staticClass:"card-img border",attrs:{alt:"/"+t.comic.title+"/cover.jpg",src:"/api/"+t.comic.title+"/cover.jpg"}})]),e("div",{staticClass:"col-8"},[e("div",{staticClass:"card-body pt-1"},[e("h2",{staticClass:"card-title"},[t._v(t._s(t.comic.title))]),e("div",{staticClass:"pb-2 text-secondary"},[e("router-link",{staticClass:"muted-link",attrs:{to:"/api/esComic/search?author="+t.comic.author,target:"_blank"}},[t._v(" "+t._s(t.comic.author)+" ")]),e("span",[t._v(" , "+t._s(new Date(t.comic.createTime).toLocaleDateString())+" ")])],1),e("div",{staticClass:"text-muted pb-2"},[e("img",{staticStyle:{width:"16px",height:"16px"},attrs:{alt:"/images/icons/tag.svg",src:"/api/images/icons/tag.svg"}}),e("span",t._l(t.comic.categories,(function(a){return e("router-link",{key:a.id,attrs:{to:"/category?categoryId=".concat(a.id)}},[t._v(" "+t._s(a.name)+"  ")])})),1)]),e("div",{staticClass:"text-muted pb-5"},[e("img",{staticStyle:{width:"16px",height:"16px"},attrs:{alt:"/images/icons/calendar.svg",src:"/api/images/icons/calendar.svg"}}),e("span",[t._v(" 最近更新: "+t._s(new Date(t.comic.lastUpdate).toLocaleDateString())+" ")])]),e("div",{staticClass:"mt-5"},[t.lastRecord?e("router-link",{staticClass:"btn btn-outline-primary mr-3",attrs:{to:"/chapter/"+t.lastRecord.chapter.id+"?page="+t.lastRecord.page,target:"_blank"}},[t._v("继续阅读")]):t.firstChapter?e("router-link",{staticClass:"btn btn-outline-primary mr-3",attrs:{to:"/chapter/"+t.firstChapter.id,target:"_blank"}},[t._v("开始阅读")]):t._e(),e("favourite",{attrs:{"comic-id":t.comicId,favourite:t.favourite}})],1)])])]),e("div",{staticClass:"mb-3 align-self-center",attrs:{id:"chapters-info"}},[e("h3",[t._v("章节列表")]),e("ul",{staticClass:"list-inline"},t._l(t.chapters.pages,(function(a){return e("li",{key:a,staticClass:"list-inline-item",class:{active:a===t.chapters.pageNum}},[e("a",{on:{click:function(e){return e.preventDefault(),t.fetchChapters(a,t.chapters.pageSize)}}},[t._v(" "+t._s(t.chapters.pageSize*(a-1)+1)+" - "+t._s(t.chapters.pageSize*a)+" ")])])})),0),e("div",{attrs:{id:"chapter-list"}},t._l(Math.ceil(t.chapters.size/5),(function(a){return e("div",{key:a,staticClass:"chapter-line"},t._l(Math.min(t.chapters.size-5*(a-1),5),(function(i){return e("router-link",{key:i,staticClass:"btn btn-outline-info text-truncate",attrs:{title:t.calcIndex(a,i)+1+" "+t.chapters.list[t.calcIndex(a,i)].title,to:"/chapter/"+t.chapters.list[t.calcIndex(a,i)].id,"data-placement":"top","data-toggle":"tooltip",target:"_blank"}},[t._v(" "+t._s(t.calcIndex(a,i)+1+" "+t.chapters.list[t.calcIndex(a,i)].title)+" ")])})),1)})),0)]),e("div",[e("h3",[t._v("评论")]),e("comment-box",{attrs:{"comic-id":t.comicId},on:{addComment:t.addComment}}),e("hr"),e("h3",[t._v("最新评论")]),t.comments?e("div",{staticClass:"comments"},[t._l(t.comments.list,(function(a){return e("comment",{key:a.id,attrs:{comment:a,firstReplies:t.repliesMap[a.id]}})})),t.comments.size?t._e():e("div",{staticClass:"text-center text-muted mb-4"},[t._v(" 目前尚未有评论。 ")]),e("nav-pag",{attrs:{action:t.fetchComments,pages:t.comments}})],2):t._e(),t.comments&&t.comments.size>5?e("comment-box",{attrs:{"comic-id":t.comicId},on:{addComment:t.addComment}}):t._e()],1)]):t._e()])},s=[],c=a("4ec3"),n=a("c8f2"),r=function(){var t=this,e=t._self._c;return t.isLogin()?e("div",{staticClass:"comment-area"},[e("div",{staticClass:"user-face pr-4"},[e("img",{attrs:{alt:"/api/"+t.user.icon,src:"/api/"+t.user.icon}})]),e("textarea",{directives:[{name:"model",rawName:"v-model.lazy",value:t.commentTxt,expression:"commentTxt",modifiers:{lazy:!0}}],staticClass:"form-control comment-text mr-4",attrs:{autocomplete:"off",cols:"8",maxlength:"500",placeholder:"写下你的评论...",required:"",rows:"2"},domProps:{value:t.commentTxt},on:{change:function(e){t.commentTxt=e.target.value}}}),e("button",{staticClass:"btn btn-primary btn-comment align-self-center",on:{click:t.comment}},[t._v("评论")])]):e("div",{staticClass:"comment-area"})},o=[],l=a("5530"),m=(a("a9e3"),a("3786")),p=a("2f62"),u={name:"CommentBox",props:{comicId:[String,Number]},data:function(){return{commentTxt:""}},computed:Object(l["a"])({},Object(p["c"])(["user"])),methods:{isLogin:function(){return Object(m["c"])()},comment:function(){var t=this;this.commentTxt&&this.commentTxt.length&&Object(c["c"])("/api/comment",{comic:{id:this.comicId},text:this.commentTxt}).then((function(e){console.log(e),e&&t.$emit("addComment",e)}))}}},d=u,f=(a("fc67"),a("2877")),v=Object(f["a"])(d,r,o,!1,null,"a80a457c",null),g=v.exports,h=function(){var t=this,e=t._self._c;return e("div",{staticClass:"comment pr-4 border-bottom"},[e("div",{staticClass:"user-face pr-4"},[e("img",{attrs:{alt:"/api/"+t.comment.user.icon,src:"/api/"+t.comment.user.icon}})]),e("div",{staticClass:"comment-details"},[e("div",{staticClass:"mb-2"},[e("router-link",{staticClass:"username",attrs:{to:"/user/"+t.comment.user.id+"/favourite"}},[t._v(" "+t._s(t.comment.user.username)+" ")])],1),e("div",{staticClass:"mb-1"},[t._v(t._s(t.comment.text))]),e("div",{staticClass:"text-muted reply-info"},[e("span",[t._v(t._s(t.formatData(t.comment.createTime)))]),e("span",{staticClass:"ml-3 btn-reply-wrap",on:{click:function(e){return t.replyClick(null)}}},[t._v(" 回复 ")])]),t.replies?[t._l(t.replies.list,(function(a){return e("div",{key:a.id,staticClass:"reply"},[e("div",{staticClass:"user-face-reply pr-2"},[e("img",{attrs:{alt:"/api/"+a.user.icon,src:"/api/"+a.user.icon}})]),e("div",[e("div",{staticClass:"mb-1"},[e("span",{staticClass:"pr-2"},[e("router-link",{staticClass:"username",attrs:{to:"/user/"+t.comment.user.id+"/favourite"}},[t._v(" "+t._s(a.user.username)+" ")])],1),a.reply?e("span",[t._v(" 回复 "),e("router-link",{attrs:{to:"/user/"+a.reply.user.id+"/favourite"}},[t._v(" "+t._s(a.reply.user.username)+" ")]),e("span",[t._v(": "+t._s(a.text))])],1):e("span",[t._v(t._s(a.text))])]),e("div",{staticClass:"text-muted reply-info"},[e("span",[t._v(t._s(t.formatData(a.createTime)))]),e("span",{staticClass:"ml-3 btn-reply-wrap",on:{click:function(e){return t.replyClick(a)}}},[t._v(" 回复 ")])])])])})),t.replies.pages>1?e("ul",{staticClass:"list-inline justify-content-end"},[e("li",{staticClass:"list-inline-item",class:{disabled:t.replies.isFirstPage}},[e("span",{on:{click:function(e){return t.fetchReplies(t.replies.prePage,t.replies.pageSize)}}},[t._v("上一页")])]),t._l(t.replies.pages,(function(a){return e("li",{key:a,staticClass:"list-inline-item",class:{active:a===t.replies.pageNum}},[e("span",{on:{click:function(e){return t.fetchReplies(a,t.replies.pageSize)}}},[t._v(" "+t._s(a)+" ")])])})),e("li",{staticClass:"list-inline-item",class:{disabled:t.replies.isLastPage}},[e("span",{on:{click:function(e){return t.fetchReplies(t.replies.nextPage,t.replies.pageSize)}}},[t._v("下一页")])])],2):t._e(),t.commentBoxSeen?[t.isLogin()?e("div",{staticClass:"comment-area"},[e("div",{staticClass:"user-face pr-4"},[e("img",{attrs:{alt:"/api/"+t.user.icon,src:"/api/"+t.user.icon}})]),e("textarea",{directives:[{name:"model",rawName:"v-model.lazy",value:t.commentTxt,expression:"commentTxt",modifiers:{lazy:!0}}],staticClass:"form-control comment-text mr-4",attrs:{autocomplete:"off",cols:"8",maxlength:"500",placeholder:"写下你的评论...",required:"",rows:"2"},domProps:{value:t.commentTxt},on:{change:function(e){t.commentTxt=e.target.value}}}),e("button",{staticClass:"btn btn-primary btn-comment align-self-center",on:{click:t.replyComment}},[t._v("评论")])]):e("div",{staticClass:"comment-area"})]:t._e()]:t._e()],2)])},C=[],_=(a("14d9"),a("fa7d")),b={name:"Comment",props:{comment:Object,firstReplies:Object},data:function(){return{reply:null,commentBoxSeen:!1,commentTxt:"",replies:this.firstReplies}},computed:Object(l["a"])({},Object(p["c"])(["user"])),methods:{isLogin:function(){return Object(m["c"])()},fetchReplies:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;c["e"].get("/api/comment/"+this.comment.id+"/replies",{params:{pageNum:e,pageSize:a}}).then((function(e){t.replies=e}))},replyClick:function(t){this.reply=t,this.commentBoxSeen=!0},replyComment:function(){var t=this;this.commentTxt&&this.commentTxt.length&&this.putRequest("/api/comment/reply",{reply:this.reply?{id:this.reply.id}:null,comment:{id:this.comment.id},text:this.commentTxt}).then((function(e){e.reply.user=t.reply.reply.user,t.replies.list.push(e),t.commentTxt=""}))},formatData:function(t){return Object(_["b"])(t)}}},x=b,y=(a("12c1"),Object(f["a"])(x,h,C,!1,null,"9496109e",null)),k=y.exports,S=a("76dd"),j={name:"Comic",components:{NavPag:S["a"],Comment:k,CommentBox:g,Favourite:n["a"]},data:function(){return{loading:!1,comic:null,lastRecord:null,chapters:null,firstChapter:null,favourite:!1,comments:null,repliesMap:null}},computed:{comicId:function(){return this.$route.params.id}},created:function(){this.fetchData()},watch:{$route:"fetchData"},methods:{fetchData:function(){var t=this;this.loading=!0,c["e"].get("/api/comic/"+this.comicId,{params:this.$route.query}).then((function(e){t.comic=e.comic,t.lastRecord=e.last_record,t.chapters=e.pages,t.firstChapter=e.first_chapter,t.favourite=e.favourite,document.title=t.comic.title,t.loading=!1,t.fetchComments()}))},fetchChapters:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;c["e"].get("/api/comic/"+this.comicId+"/chapters",{params:{pageNum:e,pageSize:a}}).then((function(e){t.chapters=e}))},fetchComments:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;c["e"].get("/api/comment/"+this.comicId,{params:{pageNum:e,pageSize:a}}).then((function(e){t.comments=e.comments,t.repliesMap=e.repliesMap}))},addComment:function(t){this.comments.list.unshift(t)},calcIndex:function(t,e){return 5*t+e-6}}},w=j,z=(a("c26f"),Object(f["a"])(w,i,s,!1,null,"40312418",null));e["default"]=z.exports},"12c1":function(t,e,a){"use strict";a("800f")},"4d1b":function(t,e,a){},"52c1":function(t,e,a){},"76dd":function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return t.pages.pages>1?e("nav",{staticClass:"mt-3",attrs:{"aria-label":"Page navigation example",id:"nav-pag"}},[e("ul",{staticClass:"pagination justify-content-center"},[e("li",{staticClass:"page-item",class:{disabled:t.pages.isFirstPage}},[e("a",{staticClass:"page-link",attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.action(t.pages.prePage,t.pages.pageSize)}}},[t._v(" Previous ")])]),t._l(t.pages.pages,(function(a){return e("li",{key:a,staticClass:"page-item",class:{active:a===t.pages.pageNum}},[e("a",{staticClass:"page-link",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.action(a,t.pages.pageSize)}}},[t._v(" "+t._s(a)+" ")])])})),e("li",{staticClass:"page-item",class:{disabled:t.pages.isLastPage}},[e("a",{staticClass:"page-link",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.action(t.pages.nextPage,t.pages.pageSize)}}},[t._v(" Next ")])])],2)]):t._e()},s=[],c={name:"NavPag",props:{pages:Object,action:Function},data:function(){return{path:this.$route.path}}},n=c,r=a("2877"),o=Object(r["a"])(n,i,s,!1,null,"08d8b84e",null);e["a"]=o.exports},"800f":function(t,e,a){},c26f:function(t,e,a){"use strict";a("4d1b")},c8f2:function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return t.isLogin()?e("span",[t.fav?e("button",{staticClass:"btn btn-outline-light btn-favourite",attrs:{"data-placement":t.position,"data-toggle":"tooltip",title:"取消订阅"},on:{click:function(e){return t.deleteFav()}}},[e("img",{attrs:{alt:"/images/icons/heart-fill.svg",height:"30px",src:"/api/images/icons/heart-fill.svg",width:"30px"}})]):e("button",{staticClass:"btn btn-outline-light btn-favourite",attrs:{"data-placement":t.position,"data-toggle":"tooltip",title:"订阅"},on:{click:function(e){return t.addFav()}}},[e("img",{attrs:{alt:"/images/icons/heart.svg",height:"30px",src:"/api/images/icons/heart.svg",width:"30px"}})])]):t._e()},s=[],c=(a("a9e3"),a("3786")),n=a("4ec3"),r={name:"Favourite",props:{favourite:Boolean,comicId:[Number,String],position:{type:String,default:"top"}},data:function(){return{fav:this.favourite}},methods:{isLogin:function(){return Object(c["c"])()},addFav:function(){var t=this;n["e"].post("/api/comic/"+this.comicId+"/addFavourite").then((function(){t.fav=!0}))},deleteFav:function(){var t=this;n["e"].post("/api/comic/"+this.comicId+"/deleteFavourite").then((function(){t.fav=!1}))}}},o=r,l=a("2877"),m=Object(l["a"])(o,i,s,!1,null,"04e9f0b4",null);e["a"]=m.exports},fc67:function(t,e,a){"use strict";a("52c1")}}]);
//# sourceMappingURL=chunk-b27e9f60.caf6615c.js.map